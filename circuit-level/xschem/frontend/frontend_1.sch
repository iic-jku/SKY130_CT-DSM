v {xschem version=3.4.0 file_version=1.2
}
G {}
K {}
V {}
S {}
E {}
T {Tail CS: M3A-NMOS-svt} 560 820 0 0 0.4 0.4 {}
T {PMOS (Diode) Load: M2A-PMOS-svt} -180 820 0 0 0.4 0.4 {}
T {Input: M2A-NMOS-svt} 260 820 0 0 0.4 0.4 {}
N -900 -30 -900 0 {
lab=GND}
N -900 -130 -900 -90 {
lab=vdd}
N -1180 50 -1110 50 {
lab=vcmi}
N -1110 50 -1110 80 {
lab=vcmi}
N -1110 50 -1040 50 {
lab=vcmi}
N -1040 -50 -1040 0 {
lab=vcmi}
N -1110 140 -1110 170 {
lab=GND}
N -1180 -130 -1180 -110 {
lab=vip}
N -1200 -130 -1180 -130 {
lab=vip}
N -1040 -130 -1040 -110 {
lab=vin}
N -1040 -130 -1020 -130 {
lab=vin}
N -1140 -100 -1110 -100 {
lab=vid}
N -1110 -100 -1080 -100 {
lab=vid}
N -1140 -60 -1140 -40 {
lab=GND}
N -1140 -40 -1110 -40 {
lab=GND}
N -1110 -40 -1080 -40 {
lab=GND}
N -1080 -60 -1080 -40 {
lab=GND}
N -1130 400 -1130 420 {
lab=GND}
N -1210 350 -1170 350 {
lab=voutn}
N -1210 250 -1170 250 {
lab=voutp}
N -1130 200 -1130 240 {
lab=voutp_p_voutn}
N -910 310 -910 340 {
lab=vcm}
N -900 380 -880 380 {
lab=#net1}
N -1170 290 -1170 320 {
lab=#net2}
N -1170 320 -1130 320 {
lab=#net2}
N -1130 320 -1130 340 {
lab=#net2}
N -900 160 -900 180 {
lab=GND}
N -900 80 -900 100 {
lab=vout}
N -1110 -40 -1110 -30 {
lab=GND}
N -1130 420 -1020 420 {
lab=GND}
N -1020 400 -1020 420 {
lab=GND}
N -1060 390 -1060 420 {
lab=GND}
N -1170 390 -1170 420 {
lab=GND}
N -1170 420 -1130 420 {
lab=GND}
N -1060 240 -1060 350 {
lab=voutp_p_voutn}
N -1130 220 -1060 220 {
lab=voutp_p_voutn}
N -1060 220 -1060 240 {
lab=voutp_p_voutn}
N -1020 320 -1020 340 {
lab=vcm_act}
N -1020 320 -970 320 {
lab=vcm_act}
N -970 380 -960 380 {
lab=GND}
N -970 320 -950 320 {
lab=vcm_act}
N -950 320 -950 340 {
lab=vcm_act}
N -970 380 -970 420 {
lab=GND}
N -1020 420 -970 420 {
lab=GND}
N -950 310 -950 320 {
lab=vcm_act}
N -1130 300 -1080 300 {
lab=GND}
N -1080 300 -1080 420 {
lab=GND}
N -1070 420 -1070 440 {
lab=GND}
N -670 540 -670 570 {
lab=vddb}
N -670 630 -670 660 {
lab=GND}
N -550 530 -530 530 {
lab=vddb}
N -670 530 -670 540 {
lab=vddb}
N -670 530 -550 530 {
lab=vddb}
N -110 30 -110 70 {
lab=voutn}
N 110 30 110 70 {
lab=voutp}
N -110 130 -110 170 {
lab=vs1}
N 110 130 110 170 {
lab=vs2}
N -800 400 -800 430 {
lab=GND}
N -800 330 -800 340 {
lab=vcm}
N -800 320 -800 330 {
lab=vcm}
N -910 320 -800 320 {
lab=vcm}
N -110 100 -80 100 {
lab=GND}
N 80 100 110 100 {
lab=GND}
N -110 -50 -110 30 {
lab=voutn}
N 110 -50 110 30 {
lab=voutp}
N 110 -100 110 -50 {
lab=voutp}
N -110 -100 -110 -50 {
lab=voutn}
N -110 0 -30 0 {
lab=voutn}
N 30 0 110 0 {
lab=voutp}
N 0 360 0 400 {
lab=GND}
N 40 310 60 310 {
lab=vbn_1}
N -20 310 0 310 {
lab=GND}
N -20 310 -20 360 {
lab=GND}
N 0 340 0 360 {
lab=GND}
N -110 -200 -110 -160 {
lab=vdd}
N 110 -200 110 -160 {
lab=vdd}
N -130 -180 -130 -130 {
lab=vdd}
N -130 -180 -110 -180 {
lab=vdd}
N 130 -180 130 -130 {
lab=vdd}
N 110 -180 130 -180 {
lab=vdd}
N -130 -130 -110 -130 {
lab=vdd}
N 110 -130 130 -130 {
lab=vdd}
N -20 360 0 360 {
lab=GND}
N -70 -130 -40 -130 {
lab=cmfb}
N 40 -130 70 -130 {
lab=cmfb}
N -80 100 80 100 {
lab=GND}
N -530 760 -530 800 {
lab=GND}
N -530 730 -510 730 {
lab=GND}
N -510 730 -510 780 {
lab=GND}
N -520 780 -510 780 {
lab=GND}
N -530 780 -520 780 {
lab=GND}
N -530 660 -530 700 {
lab=vbn_1}
N -590 730 -570 730 {
lab=vbn_1}
N -590 680 -590 730 {
lab=vbn_1}
N -590 680 -530 680 {
lab=vbn_1}
N -530 680 -500 680 {
lab=vbn_1}
N -530 530 -530 600 {
lab=vddb}
N -240 540 -200 540 {
lab=vddb}
N -220 560 -220 570 {
lab=GND}
N -220 560 -200 560 {
lab=GND}
N -370 200 -370 230 {
lab=GND}
N 370 200 370 230 {
lab=GND}
N 150 100 260 100 {
lab=vo_n}
N -260 100 -150 100 {
lab=vo_p}
N -540 70 -480 70 {
lab=vip}
N 480 70 560 70 {
lab=vin}
N 110 230 220 230 {
lab=vs2}
N 220 260 520 260 {
lab=vs2}
N 520 130 520 260 {
lab=vs2}
N 480 130 520 130 {
lab=vs2}
N -520 130 -480 130 {
lab=vs1}
N -520 130 -520 260 {
lab=vs1}
N -520 260 -220 260 {
lab=vs1}
N -220 230 -110 230 {
lab=vs1}
N -410 -30 -410 0 {
lab=vdd}
N -390 -30 -390 -0 {
lab=vbias_p}
N -370 -30 -370 0 {
lab=vcasc_p}
N -350 -30 -350 -0 {
lab=vcasc_n}
N -330 -30 -330 0 {
lab=vbias_n}
N 410 -30 410 -0 {
lab=vdd}
N 330 -30 330 -0 {
lab=vbias_n}
N 350 -30 350 -0 {
lab=vcasc_n}
N 370 -30 370 -0 {
lab=vcasc_p}
N 390 -30 390 -0 {
lab=vbias_p}
N 100 540 140 540 {
lab=vbias_p}
N 100 560 140 560 {
lab=vcasc_p}
N 100 580 140 580 {
lab=vcasc_n}
N 100 600 140 600 {
lab=vbias_n}
N -140 30 -110 30 {
lab=voutn}
N -220 30 -200 30 {
lab=vo_p}
N -220 30 -220 100 {
lab=vo_p}
N 110 30 150 30 {
lab=voutp}
N 210 30 230 30 {
lab=vo_n}
N 230 30 230 100 {
lab=vo_n}
N -40 -130 40 -130 {
lab=cmfb}
N 0 230 0 280 {
lab=vs}
N -30 230 0 230 {
lab=vs}
N 0 230 30 230 {
lab=vs}
N -110 230 -90 230 {
lab=vs1}
N 90 230 110 230 {
lab=vs2}
N -110 170 -110 230 {
lab=vs1}
N 110 170 110 230 {
lab=vs2}
N 220 230 220 260 {
lab=vs2}
N -220 230 -220 260 {
lab=vs1}
N 820 220 820 240 {
lab=#net3}
N 820 240 980 240 {
lab=#net3}
N 980 220 980 240 {
lab=#net3}
N 1100 220 1100 240 {
lab=#net4}
N 1100 240 1260 240 {
lab=#net4}
N 1260 220 1260 240 {
lab=#net4}
N 900 240 900 260 {
lab=#net3}
N 1180 240 1180 260 {
lab=#net4}
N 940 290 1140 290 {
lab=vbn_1}
N 1020 190 1060 190 {
lab=vcm}
N 980 130 980 160 {
lab=cmfb}
N 980 130 1100 130 {
lab=cmfb}
N 1100 130 1100 160 {
lab=cmfb}
N 1070 100 1070 130 {
lab=cmfb}
N 820 190 980 190 {
lab=GND}
N 1100 190 1260 190 {
lab=GND}
N 820 20 820 160 {
lab=vdd}
N 820 20 1260 20 {
lab=vdd}
N 1260 20 1260 160 {
lab=vdd}
N 1070 70 1090 70 {
lab=vdd}
N 1010 70 1030 70 {
lab=cmfb}
N 1010 70 1010 110 {
lab=cmfb}
N 1010 110 1010 130 {
lab=cmfb}
N 1070 30 1070 40 {
lab=vdd}
N 1070 -10 1070 20 {
lab=vdd}
N 740 190 780 190 {
lab=voutn}
N 1300 190 1340 190 {
lab=voutp}
N 1180 320 1180 340 {
lab=GND}
N 900 320 900 340 {
lab=GND}
N 880 330 900 330 {
lab=GND}
N 880 190 880 330 {
lab=GND}
N 880 290 900 290 {
lab=GND}
N 1180 330 1200 330 {
lab=GND}
N 1200 190 1200 330 {
lab=GND}
N 1180 290 1200 290 {
lab=GND}
N 1040 190 1040 210 {
lab=vcm}
N 1070 20 1070 30 {
lab=vdd}
N 1090 20 1090 70 {
lab=vdd}
N 140 540 340 540 {
lab=vbias_p}
N 140 560 340 560 {
lab=vcasc_p}
N 140 580 340 580 {
lab=vcasc_n}
N 140 600 340 600 {
lab=vbias_n}
N 130 540 130 640 {
lab=vbias_p}
N 190 560 190 640 {
lab=vcasc_p}
N 250 580 250 640 {
lab=vcasc_n}
N 310 600 310 640 {
lab=vbias_n}
N 130 700 130 720 {
lab=GND}
N 130 720 310 720 {
lab=GND}
N 310 700 310 720 {
lab=GND}
N 250 700 250 720 {
lab=GND}
N 190 700 190 720 {
lab=GND}
N 220 720 220 730 {
lab=GND}
N -500 680 -380 680 {
lab=vbn_1}
N -430 680 -430 720 {
lab=vbn_1}
N -430 780 -430 800 {
lab=GND}
N -1180 30 -1180 50 {
lab=vcmi}
N -1180 -50 -1180 -30 {
lab=#net5}
N -1040 0 -1040 50 {
lab=vcmi}
C {devices/vsource.sym} -900 -60 0 0 {name=V1 value=1.8
}
C {devices/gnd.sym} -900 0 0 0 {name=l1 lab=GND}
C {devices/vsource.sym} -1110 110 0 0 {name=V2 value=0.25
}
C {devices/vcvs.sym} -1040 -80 0 0 {name=E1 value=-0.5}
C {devices/vcvs.sym} -1180 -80 0 1 {name=E2 value=0.5}
C {devices/vsource.sym} -1110 -70 0 0 {name=VIN value="0 AC 1"
}
C {devices/gnd.sym} -1110 170 0 0 {name=l1 lab=GND}
C {devices/lab_pin.sym} -1200 -130 0 0 {name=l1 sig_type=std_logic lab=vip}
C {devices/lab_pin.sym} -1020 -130 0 1 {name=l1 sig_type=std_logic lab=vin
}
C {devices/lab_pin.sym} -1180 50 0 0 {name=l3 sig_type=std_logic lab=vcmi}
C {devices/vcvs.sym} -1130 370 0 0 {name=E3 value=-1
}
C {devices/lab_pin.sym} -1210 250 0 0 {name=l1 sig_type=std_logic lab=voutp
}
C {devices/vcvs.sym} -1130 270 0 0 {name=E4 value=1}
C {devices/lab_pin.sym} -1210 350 0 0 {name=l1 sig_type=std_logic lab=voutn
}
C {devices/vcvs.sym} -1020 370 0 0 {name=E5 value=0.5}
C {devices/vcvs.sym} -930 380 1 0 {name=E6 value=-100

}
C {devices/lab_pin.sym} -910 310 1 0 {name=l1 sig_type=std_logic lab=vcm}
C {devices/lab_pin.sym} -880 390 0 1 {name=l1 sig_type=std_logic lab=cmfb
}
C {devices/launcher.sym} -1100 670 0 0 {name=h1
descr="Annotate OP"
tclcommand="set show_hidden_texts 1; xschem annotate_op"}
C {sky130_fd_pr/corner.sym} -1060 530 0 0 {name=CORNER only_toplevel=false corner=tt}
C {devices/lab_pin.sym} -1110 -100 1 0 {name=l1 sig_type=std_logic lab=vid}
C {devices/lab_pin.sym} -900 -130 0 0 {name=l1 sig_type=std_logic lab=vdd}
C {devices/lab_pin.sym} -950 310 1 0 {name=l1 sig_type=std_logic lab=vcm_act}
C {devices/lab_pin.sym} -1130 200 0 0 {name=l1 sig_type=std_logic lab=voutp_p_voutn}
C {devices/gnd.sym} -900 180 0 0 {name=l1 lab=GND}
C {devices/lab_pin.sym} -900 80 0 1 {name=l1 sig_type=std_logic lab=vout}
C {devices/code.sym} -1330 530 0 0 {name=SAVE-PMOS
only_toplevel=false
value="
.control

save @m.xm2a.msky130_fd_pr__pfet_01v8[id]
save @m.xm2a.msky130_fd_pr__pfet_01v8[vth]
save @m.xm2a.msky130_fd_pr__pfet_01v8[vgs]
save @m.xm2a.msky130_fd_pr__pfet_01v8[vds]
save @m.xm2a.msky130_fd_pr__pfet_01v8[vdsat]
save @m.xm2a.msky130_fd_pr__pfet_01v8[gm]
save @m.xm2a.msky130_fd_pr__pfet_01v8[gds]
save @m.xm2a.msky130_fd_pr__pfet_01v8[cgs]

save @m.xm2b.msky130_fd_pr__pfet_01v8[id]
save @m.xm2b.msky130_fd_pr__pfet_01v8[vth]
save @m.xm2b.msky130_fd_pr__pfet_01v8[vgs]
save @m.xm2b.msky130_fd_pr__pfet_01v8[vds]
save @m.xm2b.msky130_fd_pr__pfet_01v8[vdsat]
save @m.xm2b.msky130_fd_pr__pfet_01v8[gm]
save @m.xm2b.msky130_fd_pr__pfet_01v8[gds]
save @m.xm2b.msky130_fd_pr__pfet_01v8[cgs]


.endc"}
C {devices/gnd.sym} -1110 -30 0 0 {name=l1 lab=GND}
C {sky130_fd_pr/nfet_01v8.sym} -550 730 0 0 {name=M3G
L=20
W=1
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {devices/lab_pin.sym} -380 680 2 0 {name=l7 sig_type=std_logic lab=vbn_1}
C {sky130_fd_pr/nfet_01v8.sym} 20 310 0 1 {name=M3A
L=20
W=30
nf=15
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {devices/gnd.sym} -1070 440 0 0 {name=l1 lab=GND}
C {devices/vsource.sym} -670 600 0 0 {name=V3 value=1.8
}
C {devices/gnd.sym} -670 660 0 0 {name=l1 lab=GND}
C {devices/lab_pin.sym} -640 530 1 0 {name=l1 sig_type=std_logic lab=vddb}
C {devices/isource.sym} -530 630 0 0 {name=IMAIN1 value=320n}
C {devices/code.sym} -1470 530 0 0 {name=SAVE-NMOS
only_toplevel=false
value="
.control

save @m.xm1a.msky130_fd_pr__nfet_01v8[id]
save @m.xm1a.msky130_fd_pr__nfet_01v8[vth]
save @m.xm1a.msky130_fd_pr__nfet_01v8[vgs]
save @m.xm1a.msky130_fd_pr__nfet_01v8[vds]
save @m.xm1a.msky130_fd_pr__nfet_01v8[vdsat]
save @m.xm1a.msky130_fd_pr__nfet_01v8[gm]
save @m.xm1a.msky130_fd_pr__nfet_01v8[gds]
save @m.xm1a.msky130_fd_pr__nfet_01v8[cgs]

save @m.xm1b.msky130_fd_pr__nfet_01v8[id]
save @m.xm1b.msky130_fd_pr__nfet_01v8[vth]
save @m.xm1b.msky130_fd_pr__nfet_01v8[vgs]
save @m.xm1b.msky130_fd_pr__nfet_01v8[vds]
save @m.xm1b.msky130_fd_pr__nfet_01v8[vdsat]
save @m.xm1b.msky130_fd_pr__nfet_01v8[gm]
save @m.xm1b.msky130_fd_pr__nfet_01v8[gds]
save @m.xm1b.msky130_fd_pr__nfet_01v8[cgs]

save @m.xm3a.msky130_fd_pr__nfet_01v8[id]
save @m.xm3a.msky130_fd_pr__nfet_01v8[vth]
save @m.xm3a.msky130_fd_pr__nfet_01v8[vgs]
save @m.xm3a.msky130_fd_pr__nfet_01v8[vds]
save @m.xm3a.msky130_fd_pr__nfet_01v8[vdsat]
save @m.xm3a.msky130_fd_pr__nfet_01v8[gm]
save @m.xm3a.msky130_fd_pr__nfet_01v8[gds]
save @m.xm3a.msky130_fd_pr__nfet_01v8[cgs]

save @m.xm3b.msky130_fd_pr__nfet_01v8[id]
save @m.xm3b.msky130_fd_pr__nfet_01v8[vth]
save @m.xm3b.msky130_fd_pr__nfet_01v8[vgs]
save @m.xm3b.msky130_fd_pr__nfet_01v8[vds]
save @m.xm3b.msky130_fd_pr__nfet_01v8[vdsat]
save @m.xm3b.msky130_fd_pr__nfet_01v8[gm]
save @m.xm3b.msky130_fd_pr__nfet_01v8[gds]
save @m.xm3b.msky130_fd_pr__nfet_01v8[cgs]

.endc"}
C {devices/code.sym} -1190 530 0 0 {name=STIMULI
only_toplevel=false
value="
.options savecurrents
.control
save all

let f_sig = 128
let tper_sig = 1/f_sig
let tfr_sig = tper_sig/2
alter @VIN[SIN] = [ 0 0.01 $&f_sig 0 0 0 ]
alter @VIN[DC] = 0.0

let tstep = 0.01/f_sig
let tstop = 100/f_sig
let tstart = 2500*tstep


** Main Simulations
	alter @VINDC[DC] = 0
	dc VIN -500m 500m 0.71m
	ac dec 1000 0.1 1e7
	alter @VINDC[DC] = 0.25
	tran $&tstep $&tstop $&tstart
	alter @VINDC[DC] = 0
	noise v(vout) VIN dec 100 0.1 100k 1
	noise v(vout) VIN dec 10 0.1 128

	setplot noise1
	let acgain = onoise_spectrum/inoise_spectrum

	let m1a_in = onoise.m.xm1a.msky130_fd_pr__nfet_01v8/acgain
	let m1b_in = onoise.m.xm1b.msky130_fd_pr__nfet_01v8/acgain

	let m2a_in = onoise.m.xm2a.msky130_fd_pr__pfet_01v8_lvt/acgain
	let m2b_in = onoise.m.xm2b.msky130_fd_pr__pfet_01v8_lvt/acgain

	let m3a_in = onoise.m.xm3a.msky130_fd_pr__nfet_01v8/acgain
	*let m3b_in = onoise.m.xm3b.msky130_fd_pr__nfet_01v8/acgain

	let rs_in = sqrt(onoise_rs1^2+onoise_rs2^2)/acgain

	plot inoise_spectrum m1a_in m2a_in m3a_in rs_in

	plot m2a_in m2b_in
	
	setplot ac1
	let A = v(vout)/v(vin)
	plot vdb(A) 180/PI*phase(A)
	
	setplot dc1
	let vid = v(vid)	
	let vds1 = voutn-vs1
	let vds2 = voutp-vs2
	let iod = vio#branch
	let gm  = abs(iod/vid)
	let i1a = @m.xm1a.msky130_fd_pr__nfet_01v8[id]
	let i1b = @m.xm1b.msky130_fd_pr__nfet_01v8[id]
	let i2a = @m.xm2a.msky130_fd_pr__pfet_01v8[id]
	let i2b = @m.xm2b.msky130_fd_pr__pfet_01v8[id]
	let i3a = @m.xm3a.msky130_fd_pr__nfet_01v8[id]
	*let i3b = @m.xm3b.msky130_fd_pr__nfet_01v8[id]
	let iod_2 = i1a - i1b
	let gm_2 = abs(abs(iod_2)/vid)
	plot iod iod_2
	plot gm gm_2 0
	plot vds1 vds2
	plot vip vs1 vo_p vin vs2 vo_n
	plot i1a i1b i2a i2b i3a 
	plot v(vcm_act)

	setplot tran1
	let vid = v(vid)
	let iod = vio#branch
	let is1 = @rs1[i]
	let is2 = @rs2[i]

	meas tran iod_max max iod
	meas tran vid_max max vid
	meas tran vo_p_max max vo_p
	meas tran vo_p_min min vo_p
	meas tran vo_n_max max vo_n
	meas tran vo_n_min min vo_n
	let gm = iod_max/vid_max
	let vo_p_pp = vo_p_max - vo_p_min
	let vo_n_pp = vo_n_max - vo_n_min
	*plot vid v(vout)
	plot iod
	plot vo_p vo_n
	plot is1 is2

	*plot gm

	** FFT
	
	linearize iod
	set specwindow=hanning
	fft iod
	*setplot sp4
	let iod_spec = mag(iod)
	meas sp iod_max max iod_spec
	plot iod_spec
	let N = length(iod)
	let fres = 1.707
	let sig_idx = ceil(const.f_sig/fres)
	let hd3_idx = 3*sig_idx
	let sig_pwr = iod_spec[sig_idx-1]^2+iod_spec[sig_idx]^2+iod_spec[sig_idx+1]^2
	let hd3_pwr = iod_spec[hd3_idx-1]^2+iod_spec[hd3_idx]^2+iod_spec[hd3_idx+1]^2
	let hd3 = sqrt(hd3_pwr/sig_pwr)
	let hd3_dB = 20*log10(hd3)
	

alter @VIN[DC] = 0
op
let gmId1 = @m.xm1a.msky130_fd_pr__nfet_01v8[gm]/@m.xm1a.msky130_fd_pr__nfet_01v8[id]
let gmId2 = @m.xm2a.msky130_fd_pr__pfet_01v8_lvt[gm]/@m.xm2a.msky130_fd_pr__pfet_01v8_lvt[id]
let gmId3 = @m.xm3a.msky130_fd_pr__nfet_01v8[gm]/@m.xm3a.msky130_fd_pr__nfet_01v8[id]
remzerovec
write frontend_1.raw
.endc"}
C {sky130_fd_pr/nfet_01v8.sym} -130 100 0 0 {name=M1A
L=1.5
W=10
nf=10
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 130 100 0 1 {name=M1B
L=1.5
W=10
nf=10
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {devices/lab_pin.sym} -540 70 0 0 {name=l1 sig_type=std_logic lab=vip}
C {devices/lab_pin.sym} 560 70 0 1 {name=l2 sig_type=std_logic lab=vin
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} -90 -130 0 1 {name=M2A
L=80
W=10
nf=10
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {devices/lab_pin.sym} 110 -30 2 0 {name=l1 sig_type=std_logic lab=voutp
}
C {devices/lab_pin.sym} -110 -30 2 1 {name=l1 sig_type=std_logic lab=voutn
}
C {devices/vsource.sym} -800 370 0 0 {name=V5 value=0.9
}
C {devices/gnd.sym} -800 430 0 0 {name=l4 lab=GND}
C {sky130_fd_pr/pfet_01v8_lvt.sym} 90 -130 0 0 {name=M2B
L=80
W=10
nf=10
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {devices/res.sym} -60 230 3 0 {name=RS2
value=50k
footprint=1206
device=resistor
m=1}
C {devices/gnd.sym} 0 400 0 0 {name=l9 lab=GND}
C {devices/lab_pin.sym} -110 -200 1 0 {name=l5 sig_type=std_logic lab=vdd}
C {devices/lab_pin.sym} 110 -200 1 0 {name=l11 sig_type=std_logic lab=vdd}
C {devices/lab_pin.sym} -220 230 0 0 {name=p1 sig_type=std_logic lab=vs1}
C {devices/lab_pin.sym} 220 230 0 1 {name=p2 sig_type=std_logic lab=vs2}
C {devices/vsource.sym} 0 0 1 0 {name=VIO value=0
}
C {devices/ccvs.sym} -900 130 0 0 {name=H2 vnam=vio value=1}
C {devices/gnd.sym} -530 800 0 0 {name=l13 lab=GND}
C {devices/gnd.sym} 0 100 0 0 {name=l6 lab=GND}
C {devices/lab_pin.sym} 60 310 0 1 {name=l8 sig_type=std_logic lab=vbn_1}
C {devices/ngspice_get_value.sym} 565 880 0 0 {name=r21 node=v(@m.xm3a.msky130_fd_pr__nfet_01v8[vth])
descr="vth"}
C {devices/ngspice_get_value.sym} 625 880 0 0 {name=r23 node=v(@m.xm3a.msky130_fd_pr__nfet_01v8[vgs])
descr="vgs"}
C {devices/ngspice_get_value.sym} 565 910 0 0 {name=r24 node=v(@m.xm3a.msky130_fd_pr__nfet_01v8[vds])
descr="vds"}
C {devices/ngspice_get_expr.sym} 625 910 0 0 {name=r25 node="[format %.2g [expr [ngspice::get_voltage \\\{@m.xm3a.msky130_fd_pr__nfet_01v8[vgs]\\\}] - [ngspice::get_voltage \\\{@m.xm3a.msky130_fd_pr__nfet_01v8[vth]\\\}]]]"
descr="vod"}
C {devices/ngspice_get_expr.sym} 565 940 0 0 {name=r26 node="[format %.3g [expr [ngspice::get_voltage \\\{@m.xm3a.msky130_fd_pr__nfet_01v8[vds]\\\}] - [ngspice::get_voltage \\\{@m.xm3a.msky130_fd_pr__nfet_01v8[vgs]\\\}] + [ngspice::get_voltage \\\{@m.xm3a.msky130_fd_pr__nfet_01v8[vth]\\\}]]]"
descr="vds-vod"}
C {devices/ngspice_get_value.sym} 625 940 0 0 {name=r29 node=@m.xm3a.msky130_fd_pr__nfet_01v8[gm]
descr="gm"}
C {devices/ngspice_get_expr.sym} 565 970 0 0 {name=r30 node="[format %.3g [expr 1 / [ngspice::get_node \\\{@m.xm3a.msky130_fd_pr__nfet_01v8[gds]\\\}]]]"
descr="rds"}
C {devices/ngspice_get_value.sym} 625 970 0 0 {name=r31 node=i(@m.xm3a.msky130_fd_pr__nfet_01v8[id])
descr="id"}
C {devices/ngspice_get_value.sym} 675 880 0 0 {name=r32 node=@m.xm3a.msky130_fd_pr__nfet_01v8[cgs]
descr="cgs"}
C {devices/ngspice_get_value.sym} 565 1010 0 0 {name=r33 node=v(@m.xm3a.msky130_fd_pr__nfet_01v8[vdsat])
descr="vdsat"}
C {devices/ngspice_get_expr.sym} 710 980 0 0 {name=r34 node="[format %.3g [expr [ngspice::get_node \\\{gmId3\\\}] ]]"
descr="gm_Id"}
C {devices/ngspice_get_value.sym} -70 890 0 0 {name=r10 node=v(@m.xm2a.msky130_fd_pr__pfet_01v8[vth])
descr="vth"}
C {devices/ngspice_get_value.sym} -10 890 0 0 {name=r11 node=v(@m.xm2a.msky130_fd_pr__pfet_01v8[vgs])
descr="vgs"}
C {devices/ngspice_get_value.sym} -70 920 0 0 {name=r12 node=v(@m.xm2a.msky130_fd_pr__pfet_01v8[vds])
descr="vds"}
C {devices/ngspice_get_expr.sym} -10 920 0 0 {name=r13 node="[format %.2g [expr [ngspice::get_voltage \\\{@m.xm2a.msky130_fd_pr__pfet_01v8[vgs]\\\}] - [ngspice::get_voltage \\\{@m.xm2a.msky130_fd_pr__pfet_01v8[vth]\\\}]]]"
descr="vod"}
C {devices/ngspice_get_expr.sym} -70 950 0 0 {name=r14 node="[format %.3g [expr [ngspice::get_voltage \\\{@m.xm2a.msky130_fd_pr__pfet_01v8[vds]\\\}] - [ngspice::get_voltage \\\{@m.xm2a.msky130_fd_pr__pfet_01v8[vgs]\\\}] + [ngspice::get_voltage \\\{@m.xm2a.msky130_fd_pr__pfet_01v8[vth]\\\}]]]"
descr="vds-vod"}
C {devices/ngspice_get_value.sym} -10 950 0 0 {name=r15 node=@m.xm2a.msky130_fd_pr__pfet_01v8[gm]
descr="gm"}
C {devices/ngspice_get_expr.sym} -70 980 0 0 {name=r16 node="[format %.3g [expr 1 / [ngspice::get_node \\\{@m.xm2a.msky130_fd_pr__pfet_01v8[gds]\\\}]]]"
descr="rds"}
C {devices/ngspice_get_value.sym} -10 980 0 0 {name=r47 node=i(@m.xm2a.msky130_fd_pr__pfet_01v8[id])
descr="id"}
C {devices/ngspice_get_value.sym} 40 890 0 0 {name=r19 node=@m.xm2a.msky130_fd_pr__pfet_01v8[cgs]
descr="cgs"}
C {devices/ngspice_get_value.sym} -70 1020 0 0 {name=r2 node=v(@m.xm2a.msky130_fd_pr__pfet_01v8[vdsat])
descr="vdsat"}
C {devices/ngspice_get_expr.sym} 70 990 0 0 {name=r1 node="[format %.3g [expr [ngspice::get_node \\\{gmId2\\\}] ]]"
descr="gm_Id"}
C {devices/ngspice_get_value.sym} 265 890 0 0 {name=r3 node=v(@m.xm1a.msky130_fd_pr__nfet_01v8[vth])
descr="vth"}
C {devices/ngspice_get_value.sym} 325 890 0 0 {name=r4 node=v(@m.xm1a.msky130_fd_pr__nfet_01v8[vgs])
descr="vgs"}
C {devices/ngspice_get_value.sym} 265 920 0 0 {name=r5 node=v(@m.xm1a.msky130_fd_pr__nfet_01v8[vds])
descr="vds"}
C {devices/ngspice_get_expr.sym} 325 920 0 0 {name=r6 node="[format %.2g [expr [ngspice::get_voltage \\\{@m.xm1a.msky130_fd_pr__nfet_01v8[vgs]\\\}] - [ngspice::get_voltage \\\{@m.xm1a.msky130_fd_pr__nfet_01v8[vth]\\\}]]]"
descr="vod"}
C {devices/ngspice_get_expr.sym} 265 950 0 0 {name=r7 node="[format %.3g [expr [ngspice::get_voltage \\\{@m.xm1a.msky130_fd_pr__nfet_01v8[vds]\\\}] - [ngspice::get_voltage \\\{@m.xm1a.msky130_fd_pr__nfet_01v8[vgs]\\\}] + [ngspice::get_voltage \\\{@m.xm1a.msky130_fd_pr__nfet_01v8[vth]\\\}]]]"
descr="vds-vod"}
C {devices/ngspice_get_value.sym} 325 950 0 0 {name=r8 node=@m.xm1a.msky130_fd_pr__nfet_01v8[gm]
descr="gm"}
C {devices/ngspice_get_expr.sym} 265 980 0 0 {name=r9 node="[format %.3g [expr 1 / [ngspice::get_node \\\{@m.xm1a.msky130_fd_pr__nfet_01v8[gds]\\\}]]]"
descr="rds"}
C {devices/ngspice_get_value.sym} 325 980 0 0 {name=r17 node=i(@m.xm1a.msky130_fd_pr__nfet_01v8[id])
descr="id"}
C {devices/ngspice_get_value.sym} 375 890 0 0 {name=r18 node=@m.xm1a.msky130_fd_pr__nfet_01v8[cgs]
descr="cgs"}
C {devices/ngspice_get_value.sym} 265 1020 0 0 {name=r20 node=v(@m.xm1a.msky130_fd_pr__nfet_01v8[vdsat])
descr="vdsat"}
C {devices/ngspice_get_expr.sym} 410 990 0 0 {name=r22 node="[format %.3g [expr [ngspice::get_node \\\{gmId1\\\}] ]]"
descr="gm_Id"}
C {devices/lab_pin.sym} -240 540 0 0 {name=l12 sig_type=std_logic lab=vddb}
C {devices/gnd.sym} -220 570 0 0 {name=l14 lab=GND}
C {devices/gnd.sym} -370 230 0 0 {name=l15 lab=GND}
C {devices/gnd.sym} 370 230 0 0 {name=l16 lab=GND}
C {devices/lab_pin.sym} -410 -30 1 0 {name=l17 sig_type=std_logic lab=vdd}
C {devices/lab_pin.sym} -390 -30 1 0 {name=p3 sig_type=std_logic lab=vbias_p}
C {devices/lab_pin.sym} -330 -30 1 0 {name=p4 sig_type=std_logic lab=vbias_n}
C {devices/lab_pin.sym} -370 -30 1 0 {name=p5 sig_type=std_logic lab=vcasc_p}
C {devices/lab_pin.sym} -350 -30 1 0 {name=p6 sig_type=std_logic lab=vcasc_n}
C {devices/lab_pin.sym} 410 -30 1 0 {name=l18 sig_type=std_logic lab=vdd}
C {devices/lab_pin.sym} 390 -30 1 0 {name=p7 sig_type=std_logic lab=vbias_p}
C {devices/lab_pin.sym} 370 -30 1 0 {name=p8 sig_type=std_logic lab=vcasc_p}
C {devices/lab_pin.sym} 350 -30 1 0 {name=p9 sig_type=std_logic lab=vcasc_n}
C {devices/lab_pin.sym} 330 -30 1 0 {name=p10 sig_type=std_logic lab=vbias_n}
C {devices/lab_pin.sym} 340 540 2 0 {name=p11 sig_type=std_logic lab=vbias_p}
C {devices/lab_pin.sym} 340 560 2 0 {name=p12 sig_type=std_logic lab=vcasc_p}
C {devices/lab_pin.sym} 340 580 2 0 {name=p13 sig_type=std_logic lab=vcasc_n}
C {devices/lab_pin.sym} 340 600 2 0 {name=p14 sig_type=std_logic lab=vbias_n}
C {devices/lab_pin.sym} -170 100 1 0 {name=p15 sig_type=std_logic lab=vo_p}
C {devices/lab_pin.sym} 180 100 1 0 {name=p16 sig_type=std_logic lab=vo_n}
C {devices/capa.sym} -170 30 3 0 {name=C1
m=1
value=3p
footprint=1206
device="ceramic capacitor"}
C {devices/capa.sym} 180 30 1 1 {name=C2
m=1
value=3p
footprint=1206
device="ceramic capacitor"}
C {devices/lab_pin.sym} 0 -130 1 1 {name=l19 sig_type=std_logic lab=cmfb
}
C {devices/res.sym} 60 230 1 1 {name=RS1
value=50k
footprint=1206
device=resistor
m=1}
C {devices/lab_pin.sym} 0 260 0 0 {name=p17 sig_type=std_logic lab=vs}
C {sky130_fd_pr/nfet_01v8.sym} 920 290 0 1 {name=M1
L=20
W=2
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 1160 290 0 0 {name=M2
L=20
W=2
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 800 190 0 0 {name=M3
L=1.5
W=20
nf=20
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 1000 190 0 1 {name=M4
L=1.5
W=20
nf=20
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 1080 190 0 0 {name=M5
L=1.5
W=20
nf=20
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 1280 190 0 1 {name=M6
L=1.5
W=20
nf=20
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1050 70 0 0 {name=M7
L=80
W=2
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {devices/lab_pin.sym} 1070 -10 1 0 {name=l10 sig_type=std_logic lab=vdd}
C {devices/lab_pin.sym} 1340 190 2 0 {name=l20 sig_type=std_logic lab=voutp
}
C {devices/lab_pin.sym} 740 190 2 1 {name=l21 sig_type=std_logic lab=voutn
}
C {devices/gnd.sym} 900 340 0 0 {name=l22 lab=GND}
C {devices/gnd.sym} 1180 340 0 0 {name=l23 lab=GND}
C {devices/lab_pin.sym} 1040 210 3 0 {name=l24 sig_type=std_logic lab=vcm}
C {devices/lab_pin.sym} 1100 130 0 1 {name=l25 sig_type=std_logic lab=cmfb
}
C {devices/lab_pin.sym} 1010 290 1 1 {name=l26 sig_type=std_logic lab=vbn_1}
C {devices/capa.sym} 130 670 0 0 {name=C3
m=1
value=1u
footprint=1206
device="ceramic capacitor"}
C {devices/capa.sym} 190 670 0 0 {name=C4
m=1
value=1u
footprint=1206
device="ceramic capacitor"}
C {devices/capa.sym} 250 670 0 0 {name=C5
m=1
value=1u
footprint=1206
device="ceramic capacitor"}
C {devices/capa.sym} 310 670 0 0 {name=C6
m=1
value=1u
footprint=1206
device="ceramic capacitor"}
C {devices/gnd.sym} 220 730 0 0 {name=l27 lab=GND}
C {devices/capa.sym} -430 750 0 0 {name=C7
m=1
value=1u
footprint=1206
device="ceramic capacitor"}
C {devices/gnd.sym} -430 800 0 0 {name=l28 lab=GND}
C {devices/vsource.sym} -1180 0 0 0 {name=VINDC value=0.25
}
C {/foss/designs/aux-amp/amp_gm_boost_2.sym} -330 100 0 0 {name=x4}
C {/foss/designs/aux-amp/amp_gm_boost_2.sym} 330 100 0 1 {name=x1}
C {/foss/designs/aux-amp/amp_gm_boost_bias_2.sym} -50 570 0 0 {name=x2}
